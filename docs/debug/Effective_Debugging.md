《Effective Debugging：软件和系统个调试的 66 个有效方法》

# 1 章 宏观策略

### 1条：通过事务追踪系统处理所有问题

开源的有 Bugzilla/Launch-pad/OTRS/Redmine/Trace 等，或者 JIRA 这种专有系统。

### 2条：在网上确切地查询你遇到的问题，以寻求解决灵感

简单、自足而且正确的范例（SSCCE）。搜索的时候用双引号可以更加精确搜索。搜不到可以去 stackoverflow 提问。

### 3条：确保前置条件和后置条件都满足

- 不应该为 null，却为 null 的值
- 数学函数的参数保证在定义域之内
- 对象， 结构体和数组内部细节
- 变量是否在范围之内
- 传递的数据结构是否正确，map 有没有包含预期的 key/val，链表是否可以正常遍历

### 4条：从具体问题入手向上追查 bug，或从高层程序入手向下追查 bug

- 程序崩溃。通常null/未初始化的值容易引发崩溃
- 程序冻结(freeze)：找出循环的终止条件和没有满足的原因
- 错误消息：grep 找到错误消息位置

### 5条：在正常运作的系统和发生故障的系统之间寻找差别

影响因素：代码、输入、参数、环境变量、动态链接库

- 二分搜索
- 日志对比，grep/diff/comm

### 6条：使用软件自身调试机制

- 很多命令有 debug 选项。比如 sh -x， mysql explain

### 7条：试着多种工具构建软件，并放在不同环境执行

- 用多种编译工具构建软件，不同平台执行
- 考虑用更高级的语言重新实现

### 8条：工作焦点放在最重要问题上

高优先级的 bug：

- 数据丢失
- 数据安全
- 服务可用性降低
- 使用安全
- 程序崩溃或者冻结(freeze)
- 代码质量

低优先级：

- 支持遗留系统
- 向后兼容
- 有临时解决方案的问题
- 很少用的特性

# 2 章 通用的方法与做法

### 9 条：相信自己能把问题调试好

- 确信问题是可以排查的
- 流出足够的调试时间
- 安排好环境不受干扰。进入心流
- 睡一觉
- 学习环境和工具想关知识

  - 准备好健壮的最小测试用例
  - bug 重现自动化
  - 脚本分析日志文件
  - 了解 API 或语言特性的运作方式

### 10 条：高效地重建程序中的问题

sscce: 短小的(short)，自足的(self-contained)，正确的(correct)，范例(example)

- 准确重现
- 短小正确的范例
- 创建执行环境
- 用版本管理打上标记

### 11 条：修改完代码后，要能尽快看到结果

### 12 条：将复杂的测试场景自动化

通过脚本语言执行复杂的测试用例

### 13 条：使自己尽可能多地观察到与调试有关的数据

- 扩大日志显示区域

### 14 条：考虑对软件进行更新

- 更新后重新尝试你的代码，是否还会出错？
- 谨慎考虑第三方出问题的可能，你自己出问题的几率更高

### 15 条：查看第三方组件源代码，了解其用法


