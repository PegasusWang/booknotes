<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../../../img/favicon.ico">
  <title>《Building Restful Web Services with Go》 - PegasusWang的读书笔记</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../../css/theme.css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "\u300aBuilding Restful Web Services with Go\u300b";
    var mkdocs_page_input_path = "golang/building_restful_web_services_with_go/book.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> PegasusWang的读书笔记</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../..">简介</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">代码</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../code/work_with_legacy_code/">《Work with legacy code》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../code/%E4%BB%A3%E7%A0%81%E5%A4%A7%E5%85%A8/">《代码大全》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../code/%E4%BB%A3%E7%A0%81%E7%9A%84%E6%9C%AA%E6%9D%A5/">《代码的未来》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../code/%E5%9F%BA%E6%9C%AC%E5%8A%9F/">《基本功》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../code/%E6%95%8F%E6%8D%B7%E6%8A%80%E8%83%BD%E4%BF%AE%E7%82%BC/">《敏捷技能修炼》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../code/%E7%A8%8B%E5%BA%8F%E5%91%98%E5%BA%94%E8%AF%A5%E7%9F%A5%E9%81%93%E7%9A%8497%E4%BB%B6%E4%BA%8B/">《程序员应该知道的97件事》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../code/%E7%BC%96%E5%86%99%E5%8F%AF%E8%AF%BB%E4%BB%A3%E7%A0%81%E7%9A%84%E8%89%BA%E6%9C%AF/">《编写可读代码的艺术》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../code/%E7%BC%96%E7%A8%8B%E5%8C%A0%E8%89%BA/">《编程匠艺》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../code/%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/">《领域驱动设计》</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">调试技术</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../debug/%E8%BD%AF%E4%BB%B6%E8%B0%83%E8%AF%95%E4%BF%AE%E7%82%BC%E4%B9%8B%E9%81%93/book/">《软件调试修炼之道》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../debug/Effective_Debugging/">《Effective Debugging》</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">数据库</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../database/getting_started_with_impala/">《Getting started with impala》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../database/mysql%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/">《mysql必知必会》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../database/mysql%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98%E4%B8%8E%E6%9E%B6%E6%9E%84%E5%AE%9E%E8%B7%B5/">《mysql性能调优与架构实践》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../database/Mysql%E6%8A%80%E6%9C%AF%E5%86%85%E5%B9%95InnoDB%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/">《Mysql技术内幕InnoDB存储引擎》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../database/redis%E5%AE%9E%E6%88%98/">《Redis实战》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../database/redis%E6%B7%B1%E5%BA%A6%E5%8E%86%E9%99%A9%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E5%92%8C%E5%BA%94%E7%94%A8%E5%AE%9E%E8%B7%B5/book/">《Redis深度历险核心原理和应用实践》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../database/redis%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/">《redis设计与实现》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../database/%E4%B8%83%E5%91%A8%E4%B8%83%E6%95%B0%E6%8D%AE%E5%BA%93/">《七周七数据库》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../database/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAmysql/">《深入浅出mysql》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../database/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E7%AC%AC%E4%B8%89%E7%89%88/">《高性能mysql第三版》</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">前端</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../frontend/CSS_The_Missing_Manual/">《CSS_The_Missing_Manual》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../frontend/reactjs_%E5%B0%8F%E4%B9%A6/">《reactjs小书》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../frontend/es6%E6%A0%87%E5%87%86%E5%85%A5%E9%97%A8/">《ES6标准入门》</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">golang</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../../1_the_go_programming_lauguage/">《1 The Go Programming Language》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../2_the_go_programming_lauguage/">《2 The Go Programming Language》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../3_the_go_programming_lauguage/">《3 The Go Programming Language》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../build-web-application-with-golang/">《Build Web Application With Golang》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../go101/book/">《Go101》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../network-programming-with-go/book/">《Network Programming with go》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../building-microservices-with-go/book/">《Building Microservices With Go》</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">《Building Restful Web Services with Go》</a>
    <ul class="current">
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../concurrency-in-go/concurrency_in_go/">《Concurrency In Go》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../go_in_action%28go%E8%AF%AD%E8%A8%80%E5%AE%9E%E6%88%98%29/">《Go In Action(Go 实战)》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../go%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E8%AF%AD%E8%A8%80%E8%AF%A6%E8%A7%A3/">《Go学习笔记语言详解》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../go%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/">《Go学习笔记源码剖析》</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">java</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../java/java-basic-introduction/">《java basic introduction》</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">网络</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../network/tcp_ip%E8%AF%A6%E8%A7%A3%E5%8D%B7%E4%B8%80/tcp_ip%E8%AF%A6%E8%A7%A3%E5%8D%B7%E4%B8%80/">《TCP IP详解卷一》</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">心理学</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../psychology/%E4%B8%80%E5%88%87%E9%83%BD%E6%98%AF%E7%AB%A5%E5%B9%B4%E7%9A%84%E9%94%99%E5%90%97/">《一切都是童年的错吗》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../psychology/%E4%BA%B2%E5%AF%86%E5%85%B3%E7%B3%BB/">《亲密关系》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../psychology/%E6%83%85%E5%95%86/">《情商》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../psychology/%E6%8B%96%E5%BB%B6%E5%BF%83%E7%90%86%E5%AD%A6/">《拖延心理学》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../psychology/%E7%A7%AF%E6%9E%81%E5%BF%83%E7%90%86%E5%AD%A6/">《积极心理学》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../psychology/%E8%87%AA%E6%8E%A7%E5%8A%9B/">《自控力》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../psychology/%E8%87%AA%E6%8E%A7%E5%8A%9B-%E5%92%8C%E5%8E%8B%E5%8A%9B%E5%81%9A%E6%9C%8B%E5%8F%8B/">《自控力:和压力做朋友》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../psychology/%E6%B4%BB%E5%87%BA%E6%9C%80%E4%B9%90%E8%A7%82%E7%9A%84%E8%87%AA%E5%B7%B1/">《活出最乐观的自己》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../psychology/%E6%94%B9%E5%8F%98%E5%BF%83%E7%90%86%E5%AD%A6%E7%9A%8440%E9%A1%B9%E7%A0%94%E7%A9%B6/">《改变心理学的40项研究》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../psychology/%E8%B6%85%E8%B6%8A%E8%87%AA%E5%8D%91/">《超越自卑》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../psychology/%E5%8F%8D%E8%84%86%E5%BC%B1/">《反脆弱》</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">python</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../python/fluent_python/">《Fluent Python》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../python/Python_Microservices_Development/">《Python Microservices Development》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../python/high_performance_python/">《High Performance Python》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../python/python_%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/">《Python网络编程》</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">创业</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../startup/hello_startup/">《Hello Startup》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../startup/%E6%96%AF%E5%9D%A6%E7%A6%8F%E5%85%AC%E5%BC%80%E8%AF%BE-%E5%A6%82%E4%BD%95%E5%88%9B%E4%B8%9A/">《斯坦福公开课如何创业》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../startup/%E8%BF%90%E8%90%A5%E5%85%B6%E5%AE%9E%E5%BE%88%E7%AE%80%E5%8D%95/">《运营其实很简单》</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">unix/linux</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../unix_linux/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/">《Linux高性能服务器编程》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../unix_linux/unix%E7%BC%96%E7%A8%8B%E8%89%BA%E6%9C%AF/">《unix编程艺术》</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">分布式</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E5%88%86%E5%B8%83%E5%BC%8F/Kafka%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97/">《Kafka 权威指南》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E6%A1%86%E6%9E%B6%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8/">《分布式框架原理与应用》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E5%88%86%E5%B8%83%E5%BC%8F/%E5%A4%A7%E8%A7%84%E6%A8%A1%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8%E7%B3%BB%E7%BB%9F/">《大规模分布式存储系统》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E5%88%86%E5%B8%83%E5%BC%8F/%E6%B7%B1%E5%85%A5%E5%88%86%E5%B8%83%E5%BC%8F%E7%BC%93%E5%AD%98%E4%BB%8E%E5%8E%9F%E7%90%86%E5%88%B0%E5%AE%9E%E8%B7%B5/">《深入分布式缓存从原理到实践》</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">搜索引擎</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/Elasticsearch%E5%AE%9E%E6%88%98/book/">《Elasticsearch实战》</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">开发工具</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/practical_vim/practical_vim/">《Practical Vim》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/vim8%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86%E5%AE%9E%E6%88%98/vim8%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86%E5%AE%9E%E6%88%98/">《Vim8文本处理实战》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/learn_vim_the_hard_way/">《Learn vim scrpt the hard way》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/pro_git/">《Pro Git》</a>
                    </li>
                    <li class="toctree-l1"><a class="" href="../../../开发工具/mastering_vim.md">《Mastering Vim》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/mastering_vim_quickly/">《Mastering Vim Quickly》</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">思维</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E6%80%9D%E7%BB%B4%E8%AE%A4%E7%9F%A5/%E4%B8%93%E6%B3%A8%E5%8A%9B_%E5%8C%96%E7%B9%81%E4%B8%BA%E7%AE%80%E7%9A%84%E6%83%8A%E4%BA%BA%E5%8A%9B%E9%87%8F/">《专注力》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E6%80%9D%E7%BB%B4%E8%AE%A4%E7%9F%A5/%E4%B8%BA%E4%BB%80%E4%B9%88%E7%B2%BE%E8%8B%B1%E8%BF%99%E6%A0%B7%E7%94%A8%E8%84%91%E4%B8%8D%E4%BC%9A%E7%B4%AF/">《为什么精英这样用脑不会累》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E6%80%9D%E7%BB%B4%E8%AE%A4%E7%9F%A5/%E5%88%BB%E6%84%8F%E7%BB%83%E4%B9%A0/">《刻意练习》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E6%80%9D%E7%BB%B4%E8%AE%A4%E7%9F%A5/%E5%A6%82%E4%BD%95%E6%83%B3%E5%88%B0%E5%8F%88%E5%81%9A%E5%88%B0/">《如何想到又做到》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E6%80%9D%E7%BB%B4%E8%AE%A4%E7%9F%A5/%E5%AD%A6%E4%B9%A0%E4%B9%8B%E9%81%93/">《学习之道》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E6%80%9D%E7%BB%B4%E8%AE%A4%E7%9F%A5/%E5%AD%A6%E4%B9%A0%E5%8A%9B/">《学习力》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E6%80%9D%E7%BB%B4%E8%AE%A4%E7%9F%A5/%E6%89%B9%E5%88%A4%E6%80%A7%E6%80%9D%E7%BB%B4%E5%B7%A5%E5%85%B7/">《批判性思维工具》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E6%80%9D%E7%BB%B4%E8%AE%A4%E7%9F%A5/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E6%80%9D%E7%BB%B4%E4%BF%AE%E7%82%BC%28%E5%BC%80%E5%8F%91%E8%AE%A4%E7%9F%A5%E6%BD%9C%E8%83%BD%E7%9A%84%E4%B9%9D%E5%A0%82%E8%AF%BE%29/">《程序员的思维修炼》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E6%80%9D%E7%BB%B4%E8%AE%A4%E7%9F%A5/%E8%AE%A4%E7%9F%A5%E5%A4%A9%E6%80%A7/">《认知天性》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E6%80%9D%E7%BB%B4%E8%AE%A4%E7%9F%A5/%E8%B6%85%E6%95%88%E7%8E%87%E6%89%8B%E5%86%8C/">《超效率手册》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E6%80%9D%E7%BB%B4%E8%AE%A4%E7%9F%A5/%E9%AB%98%E6%95%88%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%8445%E4%B8%AA%E4%B9%A0%E6%83%AF/">《高效程序员的45个习惯》</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">源码</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB_sourcecode/">《源码阅读》</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">网站架构微服务</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E7%BD%91%E7%AB%99%E6%9E%B6%E6%9E%84%E5%BE%AE%E6%9C%8D%E5%8A%A1/microservices_patterns_%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/book/">《微服务架构设计模式》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E7%BD%91%E7%AB%99%E6%9E%B6%E6%9E%84%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E6%9E%B6%E6%9E%84/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E6%9E%B6%E6%9E%84/">《从0开始学架构》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E7%BD%91%E7%AB%99%E6%9E%B6%E6%9E%84%E5%BE%AE%E6%9C%8D%E5%8A%A1/web_scalavility_for_startup_engineers/">《web scalavility for startup engineers》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E7%BD%91%E7%AB%99%E6%9E%B6%E6%9E%84%E5%BE%AE%E6%9C%8D%E5%8A%A1/design_data_instensive_application/">《design_data_instensive_application》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E7%BD%91%E7%AB%99%E6%9E%B6%E6%9E%84%E5%BE%AE%E6%9C%8D%E5%8A%A1/clean_architecture/">《clean_architecture》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E7%BD%91%E7%AB%99%E6%9E%B6%E6%9E%84%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E8%AE%BE%E8%AE%A1/">《微服务设计》</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">软件工程/项目管理</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B_%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86/%E4%BA%BA%E6%9C%88%E7%A5%9E%E8%AF%9D/">《人月神话》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B_%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86/%E4%BB%A3%E7%A0%81%E4%B9%8B%E6%AE%87/">《代码之殇》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B_%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86/%E8%A7%A3%E6%9E%90%E6%9E%81%E9%99%90%E7%BC%96%E7%A8%8B-%E6%8B%A5%E6%8A%B1%E5%8F%98%E5%8C%96/">《解析极限编程》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B_%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86/%E6%9E%84%E5%BB%BA%E4%B9%8B%E6%B3%95%3A%E7%8E%B0%E4%BB%A3%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B/">《构建之法:现代软件工程》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B_%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86/%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E4%BF%AE%E7%82%BC%E4%B9%8B%E9%81%93/">《项目管理修炼之道》</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">运维</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E8%BF%90%E7%BB%B4/linux%E9%9B%86%E7%BE%A4%E5%92%8C%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%90%E7%BB%B4/">《linux集群和自动化运维》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E8%BF%90%E7%BB%B4/python%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%90%E7%BB%B4/">《python自动化运维》</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">金融理财</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E9%87%91%E8%9E%8D%E7%90%86%E8%B4%A2/%E5%AE%9A%E6%8A%95%E5%8D%81%E5%B9%B4/">《定投十年》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E9%87%91%E8%9E%8D%E7%90%86%E8%B4%A2/%E7%A9%B7%E6%9F%A5%E7%90%86%E5%AE%9D%E5%85%B8/">《穷查理宝典》</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">写作</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E5%86%99%E4%BD%9C/%E5%88%B7%E5%B1%8F%E6%96%87%E6%A1%88%E5%86%99%E4%BD%9C%E6%8A%80%E5%B7%A7/">《刷屏文案写作技巧》</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">互联网</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E4%BA%92%E8%81%94%E7%BD%91/%E6%88%91%E7%9A%84%E4%BA%92%E8%81%94%E7%BD%91%E6%96%B9%E6%B3%95%E8%AE%BA-%E5%91%A8%E9%B8%BF%E7%A5%8E/">《我的互联网方法论-周鸿祎》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E4%BA%92%E8%81%94%E7%BD%91/%E7%94%A8%E6%88%B7%E6%80%9D%E7%BB%B4/">《用户思维》</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">区块链</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../%E5%8C%BA%E5%9D%97%E9%93%BE/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%8A%80%E6%9C%AF%E6%8C%87%E5%8D%97%28blockchain_guide%29/">《区块链技术指南》</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">技术演讲</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../lecture/Gopher/%E5%93%94%E5%93%A9%E5%93%94%E5%93%A9%E7%9A%84go%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%AE%9E%E6%88%98/note/">《哔哩哔哩的go微服务实战》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../lecture/Gopher/Go_Error/go%E4%B8%9A%E5%8A%A1%E5%9F%BA%E7%A1%80%E5%BA%93%E4%B9%8BError%26Context/">《go业务基础库之Error&Context》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../lecture/Gopher/Go%E5%90%8C%E6%AD%A5%E5%92%8C%E5%B9%B6%E5%8F%91%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/note/">《Go同步和并发设计模式》</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">职场</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/give_and_take/">《give and take》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/the_effective_engineer/">《the_effective_engineer》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/%E5%85%89%E9%80%9F%E6%88%90%E9%95%BF/">《光速成长》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/%E5%90%91%E4%B8%8A%E7%AE%A1%E7%90%86/">《向上管理》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/%E6%88%90%E5%8A%9F%E5%8A%A8%E6%9C%BA%E4%B8%8E%E7%9B%AE%E6%A0%87/">《成功动机与目标》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/%E7%95%AA%E8%8C%84%E5%B7%A5%E4%BD%9C%E6%B3%95/">《番茄工作法》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/%E8%81%86%E5%90%AC%E6%B2%9F%E9%80%9A%E5%AD%A6/">《聆听沟通学》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/%E7%9F%A5%E4%B9%8E%E8%81%8C%E4%BA%BA%E8%A7%89%E9%86%92/">《知乎职人觉醒》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/%E7%9F%A5%E8%AF%86%E5%8F%98%E7%8E%B0/">《知识变现》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/%E8%81%86%E5%90%AC%E6%B2%9F%E9%80%9A%E5%AD%A6/">《聆听沟通学》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/%E8%81%8C%E5%9C%BA%E5%8A%A8%E7%89%A9%E8%BF%9B%E5%8C%96%E6%89%8B%E5%86%8C/">《职场动物进化手册》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/%E8%81%8C%E5%9C%BA%E8%A7%A3%E9%87%8A%E7%B3%BB/">《职场解释系》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/%E8%AF%B7%E5%81%9C%E6%AD%A2%E6%97%A0%E6%95%88%E5%8A%AA%E5%8A%9B/">《请停止无效努力》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/%E8%BD%AF%E6%8A%80%E8%83%BD/">《软技能》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/%E9%AB%98%E6%95%8815%E6%B3%95%E5%88%99/">《高效15法则》</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../career/%E9%AB%98%E6%95%88%E6%B8%85%E5%8D%95%E5%B7%A5%E4%BD%9C%E6%B3%95/">《高效清单工作法》</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">PegasusWang的读书笔记</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
        
          <li>golang &raquo;</li>
        
      
    
    <li>《Building Restful Web Services with Go》</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p>《Building RESTful Web services with GO》 涉及面比较广，但是讲得太浅</p>
<h1 id="1-getting-started-with-rest-api-development">1. Getting started with REST API Development</h1>
<p>Live reloading the application with supervisord and gulp</p>
<h1 id="2-handling-routing-for-rest-srevices">2. Handling Routing for Rest Srevices</h1>
<h3 id="servemux-a-basic-router-in-go">ServeMux a basic router in Go</h3>
<p><code>go get github.com/julienschmidt/httprouter</code></p>
<pre><code>// execService.go

// Package main  provides ...
package main

import (
    &quot;bytes&quot;
    &quot;fmt&quot;
    &quot;log&quot;
    &quot;net/http&quot;
    &quot;os/exec&quot;

    &quot;github.com/julienschmidt/httprouter&quot;
)

func getCommandOutput(command string, arguments ...string) string {
    cmd := exec.Command(command, arguments...) //unpack
    var out bytes.Buffer
    var stderr bytes.Buffer
    cmd.Stdout = &amp;out
    cmd.Stderr = &amp;stderr
    err := cmd.Start()
    if err != nil {
        log.Fatal(fmt.Sprint(err) + &quot;: &quot; + stderr.String())
    }
    err = cmd.Wait()
    if err != nil {
        log.Fatal(fmt.Sprint(err) + &quot;: &quot; + stderr.String())
    }
    return out.String()
}

func goVersion(w http.ResponseWriter, r *http.Request, params httprouter.Params) {
    fmt.Fprintf(w, getCommandOutput(&quot;/usr/local/bin/go&quot;, &quot;version&quot;))
}

func getFileContent(w http.ResponseWriter, r *http.Request, params httprouter.Params) {
    fmt.Fprintf(w, getCommandOutput(&quot;/bin/cat&quot;, params.ByName(&quot;name&quot;)))
}

func main() {
    router := httprouter.New()
    router.GET(&quot;/api/v1/go-version&quot;, goVersion)
    router.GET(&quot;/api/v1/show-file/:name&quot;, getFileContent)
    log.Fatal(http.ListenAndServe(&quot;:8000&quot;, router))
}
</code></pre>

<h3 id="building-the-simple-static-file-server">Building the simple static file server</h3>
<pre><code>package main

import (
    &quot;log&quot;
    &quot;net/http&quot;

    &quot;github.com/julienschmidt/httprouter&quot;
)

func main() {
    router := httprouter.New()
    router.ServeFiles(&quot;/static/*filepath&quot;, http.Dir(&quot;/users/naren/static&quot;))
    log.Fatal(http.ListenAndServe(&quot;:8000&quot;, router))
}
</code></pre>

<h3 id="gorilla-mux-a-powerful-http-router">Gorilla Mux, a powerful HTTP router</h3>
<ul>
<li>Path-based matching</li>
<li>Query-based matching</li>
<li>Domain-based matching</li>
<li>Sub-domain based matching</li>
<li>Reverse URL generation</li>
</ul>
<h1 id="3-working-with-middleware-and-rpc">3. Working with Middleware and RPC</h1>
<h3 id="what-is-middleware">What is middleware?</h3>
<p>When a piece of code needs to be executed for every request or subset of HTTP requests.</p>
<h3 id="creating-a-basic-middleware">Creating a basic middleware</h3>
<pre><code>// custommiddleware.go
package main

func middleware(handler http.handler) http.handler {
    return http.handlerfunc(func(w http.responsewriter, r *http.request) {
        fmt.println(&quot;executing middleware before request phase!&quot;)
        //pass control back to handler
        handler.servehttp(w, r)
        fmt.println(&quot;executing middleware after response phase!&quot;)
    })
}

func mainlogic(w http.responsewriter, r *http.request) {
    // business logic here
    fmt.println(&quot;executing mainhandler&quot;)
    w.write([]byte(&quot;ok&quot;))
}

func main() {
    manlogichandler := http.handlerfunc(mainlogic)
    http.handler(&quot;/&quot;, middleware(manlogichandler))
    http.listenandserve(&quot;:8000&quot;, nil)
}
</code></pre>

<h3 id="multiple-middleware-and-chaining">Multiple middleware and chaining</h3>
<pre><code>// cityAPI.go
package main

import (
    &quot;encoding/json&quot;
    &quot;fmt&quot;
    &quot;net/http&quot;
)

type city struct {
    Name string
    Area uint64
}

func mainLogic(w http.ResponseWriter, r *http.Request) {
    if r.Method == &quot;POST&quot; {
        var tempCity city
        decoder := json.NewDecoder(r.Body)
        err := decoder.Decode(&amp;tempCity)
        if err != nil {
            panic(err)
        }
        defer r.Body.Close()
        // creat logic
        fmt.Printf(&quot;%s %d&quot;, tempCity.Name, tempCity.Area)
        // tell everything is fine
        w.WriteHeader(http.StatusOK)
        w.Write([]byte(&quot;201 - Created&quot;))
    } else {
        w.WriteHeader(http.StatusMethodNotAllowed)
        w.Write([]byte(&quot;405 - Method Not Allowed&quot;))
    }
}

func main() {
    http.HandleFunc(&quot;/city&quot;, mainLogic)
    http.ListenAndServe(&quot;:8000&quot;, nil)
}
</code></pre>

<p>抽象出来俩middleware:</p>
<pre><code>package main

import (
    &quot;encoding/json&quot;
    &quot;fmt&quot;
    &quot;log&quot;
    &quot;net/http&quot;
    &quot;strconv&quot;
    &quot;time&quot;
)

type city struct {
    name string
    area uint64
}

// middleware to check content type as json
func filtercontenttype(handler http.handler) http.handler {
    return http.handlerfunc(func(w http.responsewriter, r *http.request) {
        log.println(&quot;currently in the check content type middleware&quot;)
        // filtering request by mime type
        if r.header.get(&quot;content-type&quot;) != &quot;application/json&quot; {
            w.writeheader(http.statusunsupportedmediatype)
            w.write([]byte(&quot;415 - unsupported media type. please send json&quot;))
            return
        }
        handler.servehttp(w, r)
    })
}

// middle to add server timestamp for response cookie
func setservertimecookie(handler http.handler) http.handler {
    return http.handlerfunc(func(w http.responsewriter, r *http.request) {
        handler.servehttp(w, r)
        cookie := http.cookie{name: &quot;server-time(utc)&quot;, value: strconv.formatint(time.now().unix(), 10)}
        http.setcookie(w, &amp;cookie)
        log.println(&quot;currently in the set server time middleware&quot;)
    })
}

func mainlogic(w http.responsewriter, r *http.request) {
    if r.method == &quot;post&quot; {
        var tempcity city
        decoder := json.newdecoder(r.body)
        err := decoder.decode(&amp;tempcity)
        if err != nil {
            panic(err)
        }
        defer r.body.close()
        // creat logic
        fmt.printf(&quot;%s %d&quot;, tempcity.name, tempcity.area)
        // tell everything is fine
        w.writeheader(http.statusok)
        w.write([]byte(&quot;201 - created&quot;))
    } else {
        w.writeheader(http.statusmethodnotallowed)
        w.write([]byte(&quot;405 - method not allowed&quot;))
    }
}

func main() {
    mainlogichnadler := http.handlerfunc(mainlogic)
    http.handler(&quot;/city&quot;, filtercontenttype(setservertimecookie(mainlogichnadler)))
    http.listenandserve(&quot;:8000&quot;, nil)
}
</code></pre>

<h3 id="paniless-middleware-chaining-with-alice">Paniless middleware chaining with Alice</h3>
<pre><code>//go get github.com/justinas/alice

func main() {
    mainLogicHandler := http.HandlerFunc(mainLogic)
    chain := alice.New(filterContentType, setServerTimeCookie).Then(mainLogicHandler)
    http.Handle(&quot;/city&quot;, chain)
    http.ListenAndServe(&quot;:8000&quot;, nil)
}
</code></pre>

<h3 id="using-gorillas-handlers-middleware-for-logging">Using Gorilla's Handlers middleware for Logging</h3>
<ul>
<li>LoggingHandler</li>
<li>CompressingHandler: for zipping the responses</li>
<li>RecoveryHandler: for recovering from unexpected panics</li>
</ul>
<h3 id="what-is-rpc">What is RPC?</h3>
<p>"net/rpc"</p>
<h3 id="json-rpc-using-gorilla-rpc">JSON RPC using Gorilla RPC</h3>
<h1 id="4-simplifying-restful-services-with-popular-go-frameworks">4. Simplifying RESTful Services with Popular Go Frameworks</h1>
<h3 id="go-restful-a-framework-for-rest-api-creation">go-restful, a framework for REST API creation</h3>
<pre><code>package main

import (
    &quot;fmt&quot;
    &quot;io&quot;
    &quot;net/http&quot;
    &quot;time&quot;

    &quot;github.com/emicklei/go-restful&quot;
)

// brew install sqlite3
// go get github.com/emicklei/go-restful
// a simple ping server echoes the server time back to the client
func main() {
    webservice := new(restful.WebService)
    webservice.Route(webservice.GET(&quot;/ping&quot;).To(pingTime))
    restful.Add(webservice)
    http.ListenAndServe(&quot;:8000&quot;, nil)
}

func pingTime(req *restful.Request, resp *restful.Response) {
    io.WriteString(resp, fmt.Sprintf(&quot;%s&quot;, time.Now()))
}

// curl -X GET &quot;http://localhost:8000/ping&quot;
</code></pre>

<h3 id="crud-and-sqlite3-basics">CRUD and SQLite3 basics</h3>
<pre><code>// sqliteFundamentals.go
package main

import (
    &quot;database/sql&quot;
    &quot;log&quot;

    _ &quot;github.com/mattn/go-sqlite3&quot;
)

// go get github.com/mattn/go-sqlite3

type Book struct {
    id     int
    name   string
    author string
}

func main() {
    db, err := sql.Open(&quot;sqlite3&quot;, &quot;./books.db&quot;)
    log.Println(db)
    if err != nil {
        log.Println(err)
    }
    //create table
    statement, err := db.Prepare(&quot;create table if not exists books(id integer primary key, isbn integer, author(varchar(64), name varchar(64) NULL)&quot;)
    if err != nil {
        log.Println(&quot;Error in creating table&quot;)
    } else {
        log.Println(&quot;success created table books&quot;)
    }
    statement.Exec()
    // Create
    statement, _ = db.Prepare(&quot;INSERT INTO books (name, author, isbn) VALUES (?, ?, ?)&quot;)
    statement.Exec(&quot;A Tale of Two Cities&quot;, &quot;Charles Dickens&quot;, 140430547)
    log.Println(&quot;Inserted the book into database!&quot;)
    // Read
    rows, _ := db.Query(&quot;SELECT id, name, author FROM books&quot;)
    var tempBook Book
    for rows.Next() {
        rows.Scan(&amp;tempBook.id, &amp;tempBook.name, &amp;tempBook.author)
        log.Printf(&quot;ID:%d, Book:%s, Author:%s\n&quot;, tempBook.id,
            tempBook.name, tempBook.author)
    }
    // Update
    statement, _ = db.Prepare(&quot;update books set name=? where id=?&quot;)
    statement.Exec(&quot;The Tale of Two Cities&quot;, 1)
    log.Println(&quot;Successfully updated the book in database!&quot;)
    //Delete
    statement, _ = db.Prepare(&quot;delete from books where id=?&quot;)
    statement.Exec(1)
    log.Println(&quot;Successfully deleted the book in database!&quot;)
}

// 略坑啊：
// This program runs on Windows and Linux without any problem. In Go versions less than 1.8.1, you may see problems on macOS X such as Signal Killed. This is because of the Xcode version; please keep this in mind.
</code></pre>

<h3 id="building-a-metro-rail-api-with-go-restful">Building a Metro Rail APi with go-restful</h3>
<p>// go get github.com/emicklei/go-restful</p>
<h3 id="building-restful-apis-with-the-gin-framework">Building RESTful APIs with the Gin framework</h3>
<pre><code>// go get github.com/gin-gonic/gin
// ginBasic.go
package main

import (
    &quot;time&quot;

    &quot;github.com/gin-gonic/gin&quot;
)

func main() {
    r := gin.Default()
    r.GET(&quot;/pingTime&quot;, func(c *gin.Context) {
        c.JSON(200, gin.H{&quot;serverTime&quot;: time.Now().UTC()})
    })
    r.Run(&quot;:8000&quot;)
}
</code></pre>

<h3 id="building-a-restful-api-with-revelgo">Building a RESTful API with Revel.go</h3>
<p>Like Python's Django.</p>
<p>go get github.com/revel/revel</p>
<h1 id="5-working-with-mongodb-and-go-to-create-rest-apis">5. Working with MongoDB and Go to Create REST APIs</h1>
<h3 id="introducig-mgo-a-mongodb-deiver-for-go">Introducig mgo, a MongoDB deiver for Go</h3>
<p>get get gopkg.in/mgo.v2</p>
<h1 id="6-wokring-with-protocol-bufffers-and-grpc">6. Wokring with Protocol Bufffers and GRPC</h1>
<h3 id="protocol-buffer-language">Protocol buffer language</h3>
<ul>
<li>Scalar values, Enumerations, Defalut values, Nested values, Unknown types</li>
</ul>
<pre><code>syntax 'proto3';

message NetworkInterface {
  int index=1;
  int mtu=2;
  string name=3;
  string hardwareaddr=4;
}
</code></pre>

<p>the protocol buffer message will be converted to a Go struct and fiels are filled with empty defaut values.</p>
<h3 id="compiling-a-protocol-buffer-with-protoc">Compiling a protocol buffer with protoc</h3>
<p>install protobuf compiler on your meachine.  brew install protobuf</p>
<h3 id="grpc">GRPC</h3>
<p>go get google.golang.org/grpc</p>
<p>go get -u github.com/golang/protobuf/protoc-gen-go</p>
<p>Grpc has the following benefits over HTTP/REST/JSON architecture:</p>
<ul>
<li>GPRC use http/2, which is a binary protocol</li>
<li>Header compression is possible in http2</li>
<li>we can multiplex many requests on one connection</li>
<li>Usage of protobufs for strict typing of data</li>
<li>streaming of requests or responses is possible instead of request/response transactions</li>
</ul>
<h3 id="bidirectional-streaming-with-grpc">Bidirectional streaming with GRPC</h3>
<h1 id="7-working-with-postgresql-json-and-go">7. Working with PostgreSQL, JSON, and Go</h1>
<h3 id="install-postgresql">install PostgreSQL</h3>
<p>brew install postgresql &amp;&amp; brew services start postgresql // port 5432
// use psql shell create new use and database and</p>
<h3 id="pq-a-pure-postgresql-database-driver-for-go">pq, a pure PostgreSQL database driver for Go</h3>
<p>go get github.com/lib/pq</p>
<h3 id="exploring-thj-json-store-in-postgresql">Exploring thj JSON store in PostgreSQL</h3>
<p>PostgreSQL &gt; 9.2 has a feature called the JSON store.</p>
<h3 id="gorm-a-powerful-orm-for-go">GORM, a powerful ORM for GO</h3>
<p>go get -u github.com/jinzhu/gorm</p>
<h1 id="8-building-a-rest-api-client-in-go-and-unit-testing">8. Building a REST API Client in Go and Unit Testing</h1>
<h3 id="basics-for-writing-a-command-line-tool-in-go">Basics for writing a command-line tool in Go</h3>
<pre><code>// flagExample.go
package main

import (
    &quot;flag&quot;
    &quot;log&quot;
)

var name = flag.String(&quot;name&quot;, &quot;stranger&quot;, &quot;you wonderfule name&quot;)

func main() {
    flag.Parse()
    log.Printf(&quot;Hello %s&quot;, *name)
}
// ./flagExample -name laowang or ./flagExample -name=laowang
</code></pre>

<h3 id="cli-a-library-for-building-beautiful-clients">CLI - a library for building beautiful clients</h3>
<p>go get github.com/urfave/cli</p>
<pre><code>// cliBasci.go
package main

import (
    &quot;log&quot;
    &quot;os&quot;

    &quot;github.com/urfave/cli&quot;
)

func main() {
    app := cli.NewApp()
    app.Flags = []cli.Flag{
        cli.StringFlag{
            Name:  &quot;name&quot;,
            Value: &quot;stranger&quot;,
            Usage: &quot;you wonderful name&quot;,
        },
        cli.IntFlag{
            Name:  &quot;age&quot;,
            Value: 0,
            Usage: &quot;your graceful age&quot;,
        },
    }
    app.Action = func(c *cli.Context) error {
        log.Printf(&quot;Hello %s (%d years), Welcome to the command line world&quot;, c.String(&quot;name&quot;), c.Int(&quot;age&quot;))
        return nil
    }
    app.Run(os.Args)
}
</code></pre>

<h3 id="collecting-command-line-arguments-in-cli">Collecting command-line arguments in CLI</h3>
<p><img alt="" src="../flag.png" /></p>
<pre><code>// storeMarks.go
package main

import (
    &quot;log&quot;
    &quot;os&quot;

    &quot;github.com/urfave/cli&quot;
)

func main() {
    app := cli.NewApp()
    // define flags
    app.Flags = []cli.Flag{
        cli.StringFlag{
            Name:  &quot;save&quot;,
            Value: &quot;no&quot;,
            Usage: &quot;Should save to database (yes/no)&quot;,
        },
    }

    app.Version = &quot;1.0&quot;
    // define action
    app.Action = func(c *cli.Context) error {
        var args []string
        if c.NArg() &gt; 0 {
            // Fetch arguments in a array
            args = c.Args()
            personName := args[0]
            marks := args[1:len(args)]
            log.Println(&quot;Person: &quot;, personName)
            log.Println(&quot;marks&quot;, marks)
        }
        // check the flag value
        if c.String(&quot;save&quot;) == &quot;no&quot; {
            log.Println(&quot;Skipping saving to the database&quot;)
        } else {
            // Add database logic here
            log.Println(&quot;Saving to the database&quot;, args)
        }
        return nil
    }

    app.Run(os.Args)
}

// ./storeMarks --save=yes Albert 89 85 97
</code></pre>

<h3 id="grequests-a-rest-api-package-for-go">grequests - a REST API package for GO</h3>
<p>go get -u github.com/levigross/grequests</p>
<pre><code>package main

import (
    &quot;log&quot;

    &quot;github.com/levigross/grequests&quot;
)

func main() {
    resp, err := grequests.GET(&quot;http://httpbin.org/get&quot;, nil)
    if err != nil {
        log.Fatalln(&quot;Unabled to make requests: &quot;, err)
    }
    log.Println(resp.String())
}
package main

import (
    &quot;log&quot;

    &quot;github.com/levigross/grequests&quot;
)

func main() {
    resp, err := grequests.GET(&quot;http://httpbin.org/get&quot;, nil)
    if err != nil {
        log.Fatalln(&quot;Unabled to make requests: &quot;, err)
    }
    log.Println(resp.String())
}
/*
type Response struct {
    Ok bool
    Error error
    RawResponse *http.Response
    StatusCode int
    Header http.Header
}
*/
</code></pre>

<h3 id="getting-comfortable-with-the-github-rest-api">Getting comfortable with the GitHub REST API</h3>
<pre><code>// https://developer.github.com/v3/

// export GITHUB_TOKEN=YOUR_GITHUB_ACCESS_TOKEN
// getRepos.go
package main

import (
  &quot;github.com/levigross/grequests&quot;
  &quot;log&quot;
  &quot;os&quot;
)

var GITHUB_TOKEN = os.Getenv(&quot;GITHUB_TOKEN&quot;)
var requestOptions = &amp;grequests.RequestOptions{Auth: []string{GITHUB_TOKEN, &quot;x-oauth-basic&quot;}}

type Repo struct {
  ID int `json:&quot;id&quot;`
  Name string `json:&quot;name&quot;`
  FullName string  `json:&quot;full_name&quot;`
  Forks int `json:&quot;forks&quot;`
  Private bool `json:&quot;private&quot;`
}

func getStats(url string) *grequests.Response{
  resp, err := grequests.Get(url, requestOptions)
  // You can modify the request by passing an optional RequestOptions struct
  if err != nil {
    log.Fatalln(&quot;Unable to make request: &quot;, err)
  }
  return resp
}

func main() {
  var repos []Repo
  var repoUrl = &quot;https://api.github.com/users/torvalds/repos&quot;
  resp := getStats(repoUrl)
  resp.JSON(&amp;repos)
  log.Println(repos)
}
</code></pre>

<h3 id="using-redis-for-caching-the-api-data">Using Redis for caching the API data</h3>
<p>go get github.com/go-redis/redis</p>
<h3 id="creating-a-unit-testing-tool-for-our-url-shortening-service">Creating a unit testing tool for our URL shortening service</h3>
<pre><code>package main_test

import (
    &quot;net/http&quot;
    &quot;testing&quot;
)

func TestGetoOriginalURL(t *testing.T) {
    response, err := http.Get(&quot;http://localhost:8000/v1/short/1&quot;)
    if http.StatusOK != response.StatusCode {
        t.Errorf(&quot;Expected response code %d. Got %d\n&quot;, http.StatusOK)
    }
    if err != nil {
        t.Errorf(&quot;encoutered an error:&quot;, err)
    }
}
</code></pre>

<h1 id="9-scaling-our-rest-api-using-microservices">9. Scaling Our REST API Using Microservices</h1>
<p>The disadvantage list of a monolithic application could be:</p>
<ul>
<li>Tightly coupled architecture</li>
<li>Single point of failure</li>
<li>Velocity of adding new features and components</li>
<li>Fragmentation of work is limited to teams</li>
<li>Continuous deployment is very tough because an entire application needs to be pushed</li>
</ul>
<p>Microservices bring the following benefits to the plate:</p>
<ul>
<li>If the team is big, people can work on chunks of applications</li>
<li>Adaptability is easy for the new developers</li>
<li>Adopting best practices, such as Continuous Integration (CI) and Continuous Delivery (CD)</li>
<li>Easily replaceable software with loosely coupled architecture</li>
</ul>
<h3 id="go-kit-a-package-for-building-microservices">Go Kit, a package for building microservices</h3>
<p>go get github.com/go-kit/kit</p>
<h1 id="10-deplying-our-rest-srevices">10. Deplying Our REST srevices</h1>
<h3 id="proxy-server">proxy server</h3>
<p>The benefits of having a proxy server (Nginx):</p>
<ul>
<li>It can act as a load balancer</li>
<li>It can sit in front of cluster of applications and redirect HTTP requests</li>
<li>It can serve a filesystem with a good performance</li>
<li>It streams media very well</li>
</ul>
<h3 id="load-balancing-with-nginx">Load balancing with Nginx</h3>
<ul>
<li>Round Robin</li>
<li>Least Coonection: send to the server that is currently serving the least number of clients</li>
<li>IP HASH</li>
<li>Least Time: send to the machine with the lowest average latency time</li>
</ul>
<h3 id="rate-limiting-our-rest-api">Rate limiting our REST API</h3>
<p>limit_conn_zone</p>
<h1 id="11-using-an-api-gateway-to-monitor-and-metricize-rest-api">11. Using an API Gateway to Monitor and Metricize REST API</h1>
<p>They are authentication, logging, rate limiting, and so on. The best way to add those features is to use an API gateway.</p>
<h3 id="why-is-an-api-gateway-required">Why is an API gateway required?</h3>
<p>An api gateway is a fine piece of middleware does these things:</p>
<ul>
<li>Loggig</li>
<li>Security</li>
<li>Traffic control</li>
<li>Transformations</li>
</ul>
<h3 id="kong-an-open-source-api-gateway">Kong, an open-source API gateway</h3>
<p>Kong is a cloud-native, fast, scalable, and distributed Microservice Abstraction Layer (also known as an API Gateway, API Middleware or in some cases Service Mesh). Made available as an open-source project in 2015, its core values are high performance and extensibility.
Combination of OpenResty and Nginx.</p>
<h1 id="12-handling-authentication-for-our-rest-services">12 Handling Authentication for Our REST Services</h1>
<ul>
<li>session-based authentication</li>
<li>JSON Web Tokens (JWT)</li>
<li>Authentication2(OAuth2)</li>
</ul>
<pre><code>//go get github.com/gorilla/sessions
var store = sessions.NewCookieStore([]byte(&quot;secret_key&quot;))
</code></pre>

<h3 id="session-based-authentication">session-based authentication</h3>
<pre><code>package main

import (
    &quot;log&quot;
    &quot;net/http&quot;
    &quot;os&quot;
    &quot;time&quot;

    &quot;github.com/gorilla/mux&quot;
    &quot;github.com/gorilla/sessions&quot;
)

// os.Getenv return empty string &quot;&quot; if not exists key
var store = sessions.NewCookieStore([]byte(os.Getenv(&quot;SESSION_SECRET&quot;)))

var users = map[string]string{&quot;naren&quot;: &quot;passme&quot;, &quot;admin&quot;: &quot;password&quot;}

func HealthcheckHandler(w http.ResponseWriter, r *http.Request) {
    session, _ := store.Get(r, &quot;session.id&quot;)
    if (session.Values[&quot;authenticated&quot;] != nil) &amp;&amp; session.Values[&quot;authenticated&quot;] != false {
        w.Write([]byte(time.Now().String()))
    } else {
        http.Error(w, &quot;Forbidden&quot;, http.StatusForbidden)
    }
}

func LoginHandler(w http.ResponseWriter, r *http.Request) {
    session, _ := store.Get(r, &quot;session.id&quot;)
    err := r.ParseForm()
    if err != nil {
        http.Error(w, &quot;pass the data as URL form encoded&quot;, http.StatusBadRequest)
        return
    }
    username := r.PostForm.Get(&quot;username&quot;)
    password := r.PostForm.Get(&quot;password&quot;)

    if originalPassword, ok := users[username]; ok {
        if password == originalPassword {
            session.Values[&quot;authenticated&quot;] = true
            session.Save(r, w) // save to response
        } else {
            http.Error(w, &quot;Invalid credentials&quot;, http.StatusUnauthorized)
            return
        }
    } else {
        http.Error(w, &quot;user is not found&quot;, http.StatusNotFound)
        return
    }
    w.Write([]byte(&quot;Logged In success&quot;))
}

func LogoutHandler(w http.ResponseWriter, r *http.Request) {
    session, _ := store.Get(r, &quot;session.id&quot;)
    session.Values[&quot;authenticated&quot;] = false
    session.Save(r, w)
    w.Write([]byte(&quot;&quot;))
}

func main() {
    r := mux.NewRouter()
    r.HandleFunc(&quot;/login&quot;, LogoutHandler)
    r.HandleFunc(&quot;/health&quot;, HealthcheckHandler)
    r.HandleFunc(&quot;/logout&quot;, LogoutHandler)
    http.Handle(&quot;/&quot;, r)
    srv := &amp;http.Server{
        Handler:      r,
        Addr:         &quot;127.0.0.1:8000&quot;,
        WriteTimeout: 15 * time.Second,
        ReadTimeout:  15 * time.Second,
    }
    log.Fatal(srv.ListenAndServe())

}
</code></pre>

<pre><code class="py"># test py code
import requests

resp = requests.post(&quot;http://localhost:8000/login&quot;, data={&quot;username&quot;: &quot;admin&quot;, &quot;password&quot;: &quot;password&quot;})
print(resp.text)
assert resp.status_code == 200

cookies = resp.cookies
resp = requests.get(&quot;http://localhost:8000/health&quot;, cookies=cookies)
print(resp.text)
assert resp.status_code == 200
</code></pre>

<h3 id="jwt">JWT</h3>
<p><img alt="" src="../jwt.png" /></p>
<h3 id="json-web-token-format">Json web token format</h3>
<ul>
<li>Create a JWT header by doing Base64Url encoding on the header JSON.</li>
<li>Create a JWT payload by doing Base64Url encoding on the payload JSON.</li>
<li>Create a signature by encrypting the appended header and payload using a secret key.</li>
<li>JWT string can be obtained by appending the header, payload, and signature.</li>
</ul>
<p>signature = HMACSHA256( base64UrlEncode(header) + "." + base64UrlEncode(payload), secret)
tokenString = base64UrlEncode(header) + "." + base64UrlEncode(payload) + "." + signature</p>
<p>go get github.com/dgrijalva/jwt-go</p>
<h3 id="auth2">Auth2</h3>
<p>Authentication is the process of identifying whether a client is genuine or not. When a server authenticates a client, it checks the username/password pair and creates session cookie/JWT.</p>
<p>Authorization is the process of differentiating one client from another after a successful authentication. In cloud services, the resources requested by a client need to be served by checking that the resources belong to that client but not the other client. The permissions and access to resources vary for different clients. For example, the admin has the highest privileges of resources. A normal user's access is limited.</p>
<p>OAuth2 is a protocol for authenticating multiple clients to a service, whereas the JWT is a token format. We need to encode/decode JWT tokens to implement the second stage (dashed lines in the following screenshot) of OAuth 2.</p>
<p><img alt="" src="../oauth2.png" /></p>
<pre><code>package main

import (
    &quot;encoding/json&quot;
    &quot;fmt&quot;
    &quot;log&quot;
    &quot;net/http&quot;
    &quot;os&quot;
    &quot;time&quot;

    jwt &quot;github.com/dgrijalva/jwt-go&quot;
    &quot;github.com/dgrijalva/jwt-go/request&quot;
    &quot;github.com/gorilla/mux&quot;
)

var secretKey = []byte(os.Getenv(&quot;SESSION_SECRET&quot;))

// var secretKey = []byte(&quot;test&quot;)

var users = map[string]string{&quot;naren&quot;: &quot;passme&quot;, &quot;admin&quot;: &quot;password&quot;}

// json response for jwt
type Response struct {
    Token  string `json:&quot;token&quot;`
    Status string `json:&quot;status&quot;`
}

func HealthcheckHandler(w http.ResponseWriter, r *http.Request) {
    tokenString, err := request.HeaderExtractor{&quot;access_token&quot;}.ExtractToken(r)
    token, err := jwt.Parse(tokenString, func(token *jwt.Token) (interface{}, error) {
        // Don't forget to validate the alg is what you expect:
        if _, ok := token.Method.(*jwt.SigningMethodHMAC); !ok {
            return nil, fmt.Errorf(&quot;Unexpected signing method: %v&quot;, token.Header[&quot;alg&quot;])
        }
        // hmacSampleSecret is a
        return secretKey, nil
    })
    if err != nil {
        w.WriteHeader(http.StatusForbidden)
        w.Write([]byte(&quot;Access Denied; Please check access token&quot;))
        return
    }

    if claims, ok := token.Claims.(jwt.MapClaims); ok &amp;&amp; token.Valid {
        // If token is valid
        response := make(map[string]string)
        // response[&quot;user&quot;] = claims[&quot;username&quot;]
        response[&quot;time&quot;] = time.Now().String()
        response[&quot;user&quot;] = claims[&quot;username&quot;].(string) // claims value is interface, convert to string
        responseJSON, _ := json.Marshal(response)
        w.Write(responseJSON)
    } else {
        w.WriteHeader(http.StatusForbidden)
        w.Write([]byte(err.Error()))
    }
}

// LoginHandler validates the user credentials
func getTokenHandler(w http.ResponseWriter, r *http.Request) {
    err := r.ParseForm()
    if err != nil {
        http.Error(w, &quot;Please pass the data as URL form encoded&quot;, http.StatusBadRequest)
        return
    }
    username := r.PostForm.Get(&quot;username&quot;)
    password := r.PostForm.Get(&quot;password&quot;)
    if originalPassword, ok := users[username]; ok {
        if password == originalPassword {
            // Create a claims map
            claims := jwt.MapClaims{
                &quot;username&quot;:  username,
                &quot;ExpiresAt&quot;: 15000,
                &quot;IssuedAt&quot;:  time.Now().Unix(),
            }
            token := jwt.NewWithClaims(jwt.SigningMethodHS256, claims)
            tokenString, err := token.SignedString(secretKey)
            if err != nil {
                w.WriteHeader(http.StatusBadGateway)
                w.Write([]byte(err.Error()))
            }
            response := Response{Token: tokenString, Status: &quot;success&quot;}
            responseJSON, _ := json.Marshal(response)
            w.WriteHeader(http.StatusOK)
            w.Header().Set(&quot;Content-Type&quot;, &quot;application/json&quot;)
            w.Write(responseJSON)
        } else {
            http.Error(w, &quot;Invalid Credentials&quot;, http.StatusUnauthorized)
            return
        }
    } else {
        http.Error(w, &quot;User is not found&quot;, http.StatusNotFound)
        return

    }
}
func main() {
    r := mux.NewRouter()
    r.HandleFunc(&quot;/getToken&quot;, getTokenHandler)
    r.HandleFunc(&quot;/healthcheck&quot;, HealthcheckHandler)
    http.Handle(&quot;/&quot;, r)
    srv := &amp;http.Server{
        Handler: r,
        Addr:    &quot;127.0.0.1:8000&quot;,
        // Good practice: enforce timeouts for servers you create!
        WriteTimeout: 15 * time.Second,
        ReadTimeout:  15 * time.Second,
    }
    log.Fatal(srv.ListenAndServe())
}
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../concurrency-in-go/concurrency_in_go/" class="btn btn-neutral float-right" title="《Concurrency In Go》">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../building-microservices-with-go/book/" class="btn btn-neutral" title="《Building Microservices With Go》"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../../building-microservices-with-go/book/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../concurrency-in-go/concurrency_in_go/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
      <script src="../../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
